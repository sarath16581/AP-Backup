<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Add_Products_Access_Validation</fullName>
    <active>true</active>
    <description>&apos;Add Products&apos; action&apos;s accessibility based on Profile, Opportunity Sub Type and Special Roles</description>
    <errorConditionFormula>NOT(
	OR(
	OR(
		$Profile.Name = &apos;Sales Admin&apos;,
		$Profile.Name = &apos;Enterprise Onboarding&apos;,
		$Profile.Name = &apos;System Administrator&apos;,
		AND(
			OR(ISPICKVAL(Opportunity.Opportunity_SubType__c,&quot;Re-Contract&quot;), ISPICKVAL(Opportunity.Opportunity_SubType__c,&quot;DoV Increase&quot;)),
			$Profile.Name = &apos;BG Base&apos;,
			OR(
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_North_Sales_Specialists_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_NSW_1_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_NSW_2_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_QLD_NT_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_South_Sales_Specialists_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_1_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_2_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_3_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_4_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Financial_Institutions_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Government_North_National_Defence_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Government_North_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Government_South_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Intermediaries_SR.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Financial_Institutions_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Government_North_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_1_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_3_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_North_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_2_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_NSW_1_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_QLD_NT_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Government_South_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Intermediaries_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_NSW_2_Sales_Manager.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_South_Director_Sales.MasterLabel = $UserRole.Name,
				$CustomMetadata.Add_Products_Sales_Specialist__mdt.Enterprise_VIC_4_Sales_Manager.MasterLabel = $UserRole.Name,
				&apos;Government North - National Defence - Sales Manager&apos; = $UserRole.Name
			)
		)
	),
	NOT(ISBLANK(Contract_Number__c))
	)
)</errorConditionFormula>
    <errorMessage>Products can only be added using &apos;Add Pricing Products&apos; button on the Opportunity.</errorMessage>
</ValidationRule>
