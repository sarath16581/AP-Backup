<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>49.0</apiVersion>
    <formulas>
        <name>NewStartDate</name>
        <dataType>Date</dataType>
        <expression>CASE({!Frequncy}  ,  &quot;Daily&quot;,  {!TaskStartDate} +CASE( 
MOD({!TaskStartDate} - DATE(1900, 1, 7), 7), 
5, 3, 
6, 2,
1),
   &quot;Weekly&quot;, {!TaskStartDate} +7, &quot;Monthly&quot;, {!TaskStartDate} +30,&quot;Bi-Monthly&quot;,{!TaskStartDate}+60,&quot;Quarterly&quot;,{!TaskStartDate} +90,&quot;Bi-Yearly&quot;,{!TaskStartDate}+180,&quot;Yearly&quot;,{!TaskStartDate}+365,{!TaskStartDate})</expression>
    </formulas>
    <interviewLabel>{!TAMID} -{!caseID} -{!TaskStartDate}</interviewLabel>
    <label>TAM Case Close Flow</label>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>TAM_Lookup</name>
        <label>TAM ID Lookup</label>
        <locationX>203</locationX>
        <locationY>59</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>TAM_Lookup_1</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>caseID</elementReference>
            </value>
        </filters>
        <object>Case</object>
        <outputAssignments>
            <assignToReference>TAMID</assignToReference>
            <field>Auto_Task_Reference__c</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>TAM_Lookup_1</name>
        <label>TAM Lookup</label>
        <locationX>215</locationX>
        <locationY>156</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_TAM</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>TAMID</elementReference>
            </value>
        </filters>
        <object>Task_Automation_Management__c</object>
        <outputAssignments>
            <assignToReference>Frequncy</assignToReference>
            <field>Frequency__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>TaskStartDate</assignToReference>
            <field>Task_Start_Date__c</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Update_TAM</name>
        <label>Update TAM</label>
        <locationX>238</locationX>
        <locationY>281</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>TAMID</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Case_Assigned__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_Case_Scheduled_Date__c</field>
            <value>
                <elementReference>TaskStartDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Task_Start_Date__c</field>
            <value>
                <elementReference>NewStartDate</elementReference>
            </value>
        </inputAssignments>
        <object>Task_Automation_Management__c</object>
    </recordUpdates>
    <startElementReference>TAM_Lookup</startElementReference>
    <status>Active</status>
    <variables>
        <name>caseID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Frequncy</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>TAMID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>TaskStartDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
