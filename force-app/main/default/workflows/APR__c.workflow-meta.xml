<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Send_Email_to_APR_Owner</fullName>
        <description>Send Email to APR Owner</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>All_Email_Templates/APR_for_Billing_Accts_Aproval</template>
    </alerts>
    <alerts>
        <fullName>Send_Email_to_APR_Owner_Approval</fullName>
        <description>Send Email to APR Owner</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>All_Email_Templates/APR_for_Billing_Accts_Aproval</template>
    </alerts>
    <alerts>
        <fullName>Send_Email_to_APR_Owner_Rejection</fullName>
        <description>Send Email to APR Owner Rejection</description>
        <protected>false</protected>
        <recipients>
            <type>accountOwner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>All_Email_Templates/APR_for_Billing_Accts_Rejection</template>
    </alerts>
    <fieldUpdates>
        <fullName>APR_Auto_Populate_Conclusion_Date</fullName>
        <description>Auto populate conclusion date data as per published date data</description>
        <field>Conclusion_Date__c</field>
        <formula>Published_Date__c</formula>
        <name>APR Auto Populate Conclusion Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>APR_Auto_Populate_Confirmed_Rate</fullName>
        <description>Auto populate confirmed rate field data as per published rate data</description>
        <field>Confirmed_Rate__c</field>
        <formula>Published_Rate__c</formula>
        <name>APR Auto Populate Confirmed Rate</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>APR_Blank_Conclusion_Date</fullName>
        <field>Conclusion_Date__c</field>
        <name>APR Blank Conclusion Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>APR_Blank_Confirmed_Rate</fullName>
        <field>Confirmed_Rate__c</field>
        <name>APR Blank Confirmed Rate</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>APR_Blank_Effective_Date</fullName>
        <field>Confirmed_Date__c</field>
        <name>APR Blank Effective Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>APR_Update_Processed_Date_to_today</fullName>
        <field>Processed_Date__c</field>
        <formula>today()</formula>
        <name>APR - Update Processed Date to today</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Comments_Update</fullName>
        <description>Update APR Comments after approval or rejection</description>
        <field>Comments__c</field>
        <formula>Comments__c +  PRIORVALUE( Comments__c )</formula>
        <name>Comments Update</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Approval_Status</fullName>
        <field>Approval_Status__c</field>
        <name>Update Approval Status</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Approval_Status_Pending_Approval</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Pending Approval</literalValue>
        <name>Update Approval Status Pending Approval</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Conclusion_Date_to_3110YEAR</fullName>
        <field>Conclusion_Date__c</field>
        <formula>DATE(YEAR(TODAY())+1,10,31)</formula>
        <name>Update Conclusion Date to 3110YEAR</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Confirmed_Rate</fullName>
        <field>Confirmed_Rate__c</field>
        <formula>Published_Rate__c</formula>
        <name>Update Confirmed Rate</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Confirmed_Rate_to</fullName>
        <field>Confirmed_Rate__c</field>
        <formula>Published_Rate__c</formula>
        <name>Update Confirmed Rate to PR</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Confirmed_Rate_to_Zero</fullName>
        <field>Confirmed_Rate__c</field>
        <formula>0.00</formula>
        <name>Update Confirmed Rate to Zero</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Effective_Date_to_0111YEAR</fullName>
        <field>Confirmed_Date__c</field>
        <formula>DATE(YEAR(TODAY()),11,1)</formula>
        <name>Update Effective Date to 0111YEAR</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Published_Rate_to_Zero</fullName>
        <field>Published_Rate__c</field>
        <formula>0.00</formula>
        <name>Update Published Rate to Zero</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Approved2</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Approved</literalValue>
        <name>Update Status</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Pending_Approval</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Pending Approval</literalValue>
        <name>Update Status Pending Approval</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Pending_Approval2</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Pending Approval</literalValue>
        <name>Update Status Pending Approval</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Pending_Approval3</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Pending Approval</literalValue>
        <name>Update Status Pending Approval</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Rejected</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Update Status Rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Rejected2</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Update Status</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Rejected3</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Update Status Rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Status_Rejected4</fullName>
        <field>Approval_Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Update Status Rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>APR - Update Processed Date to today</fullName>
        <actions>
            <name>APR_Update_Processed_Date_to_today</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>APR__c.Entered_in_Team_PeopleSoft__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>APR__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>StarTrack</value>
        </criteriaItems>
        <description>This rule is designed to fire when the &quot;Entered in Team / PeopleSoft&quot; box is ticked to update the Processed Date to today</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Auto Date Fields for Open and Unresolved Status</fullName>
        <actions>
            <name>APR_Blank_Conclusion_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>APR_Blank_Confirmed_Rate</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>APR_Blank_Effective_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>APR__c.Status__c</field>
            <operation>equals</operation>
            <value>Open,Unresolved</value>
        </criteriaItems>
        <criteriaItems>
            <field>APR__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>StarTrack</value>
        </criteriaItems>
        <description>Update Effective Date and Conclusion Date fields when Open or Unresolved status is selected</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Auto Date Fields for Reduction Status</fullName>
        <actions>
            <name>Update_Conclusion_Date_to_3110YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Effective_Date_to_0111YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>APR__c.Status__c</field>
            <operation>equals</operation>
            <value>Reduction</value>
        </criteriaItems>
        <criteriaItems>
            <field>APR__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>StarTrack</value>
        </criteriaItems>
        <description>Update Effective Date and Conclusion Date fields when Reduction status is selected</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Auto Fields for Accepted%2C Auto-Accepted and Account Lost Status</fullName>
        <actions>
            <name>Update_Conclusion_Date_to_3110YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Effective_Date_to_0111YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>APR__c.Status__c</field>
            <operation>equals</operation>
            <value>Accepted,Auto-Accepted,Account Lost</value>
        </criteriaItems>
        <criteriaItems>
            <field>APR__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>StarTrack</value>
        </criteriaItems>
        <description>When Accepted, Auto-Accepted or Account Lost status is selected update fields</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Auto Fields for Exemption Status</fullName>
        <actions>
            <name>Update_Conclusion_Date_to_3110YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Confirmed_Rate_to_Zero</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Effective_Date_to_0111YEAR</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>APR__c.Status__c</field>
            <operation>equals</operation>
            <value>Exemption</value>
        </criteriaItems>
        <criteriaItems>
            <field>APR__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>StarTrack</value>
        </criteriaItems>
        <description>Update Confirmed Rate, Published Rate, Effective Date and Conclusion Date fields when Exemption status is selected</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Update Confirmed Rate if Null</fullName>
        <actions>
            <name>Update_Confirmed_Rate</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update Confirmed Rate using Published Rate if Null and Status is &apos;Auto-Accepted&apos; or &apos;Account Lost&apos;</description>
        <formula>AND (   RecordType.DeveloperName = &apos;StarTrack&apos;, 
ISBLANK(Confirmed_Rate__c),
OR(  
ISPICKVAL(Status__c , &apos;Auto-Accepted&apos;),  
ISPICKVAL(Status__c , &apos;Account Lost&apos;)   
) 
)</formula>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
</Workflow>
